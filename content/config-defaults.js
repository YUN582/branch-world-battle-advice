// ============================================================
// Branch World Battle Roll - ì„¤ì • ê¸°ë³¸ê°’
// ì½”ì½”í¬ë¦¬ì•„ GM ë³´ì¡° í™•ì¥ í”„ë¡œê·¸ë¨
// ============================================================

window.BWBR_DEFAULTS = {
  // â”€â”€ ë©”ì‹œì§€ í…œí”Œë¦¿ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  templates: {
    // í•© ê°œì‹œ íŠ¸ë¦¬ê±° (ì´ íŒ¨í„´ì´ ì±„íŒ…ì— ë‚˜íƒ€ë‚˜ë©´ ì „íˆ¬ ì‹œì‘)
    // {attacker}, {defender} = ì´ë¦„
    // {atkDice}, {atkCrit}, {atkFumble} = ê³µê²©ì ì£¼ì‚¬ìœ„/ëŒ€ì„±ê³µ/ëŒ€ì‹¤íŒ¨
    // {defDice}, {defCrit}, {defFumble} = ë°©ì–´ì ì£¼ì‚¬ìœ„/ëŒ€ì„±ê³µ/ëŒ€ì‹¤íŒ¨
    combatStart:
      'ã€Ší•© ê°œì‹œã€‹| âš”ï¸ {attacker} - {atkDice}/{atkCrit}/{atkFumble} | ğŸ›¡ï¸ {defender} - {defDice}/{defCrit}/{defFumble}',

    // ê° í•© í—¤ë”
    roundHeader:
      'ã€Š{round}í•©ã€‹\nâš”ï¸ {attacker} {atkDice} : ğŸ›¡ï¸ {defender} {defDice}',

    // ê³µê²©ì ì£¼ì‚¬ìœ„ êµ´ë¦¼ ëª…ë ¹
    attackerRoll: '1D20 âš”ï¸ {attacker} @{sound}',

    // ë°©ì–´ì ì£¼ì‚¬ìœ„ êµ´ë¦¼ ëª…ë ¹
    defenderRoll: '1D20 ğŸ›¡ï¸ {defender} @{sound}',

    // í•© ê²°ê³¼ ë©”ì‹œì§€
    roundResultWin:
      'âš”ï¸ {attacker}ã€{atkValue}ã€‘ vs ğŸ›¡ï¸ {defender}ã€{defValue}ã€‘ â†’ {winner} ìŠ¹ë¦¬!',
    roundResultCrit:
      'ğŸ’¥ {name} ëŒ€ì„±ê³µ! ã€{value}ã€‘ â†’ ìƒëŒ€ ì£¼ì‚¬ìœ„ íŒŒê´´ & ì£¼ì‚¬ìœ„ +1',
    roundResultFumble:
      'ğŸ’€ {name} ëŒ€ì‹¤íŒ¨! ã€{value}ã€‘ â†’ ìì‹  ì£¼ì‚¬ìœ„ íŒŒê´´ & ì£¼ì‚¬ìœ„ -1',
    roundResultBothCrit:
      'âš¡ ìŒë°© ëŒ€ì„±ê³µ! âš”ï¸ã€{atkValue}ã€‘ ğŸ›¡ï¸ã€{defValue}ã€‘ â†’ ê°ì ì£¼ì‚¬ìœ„ +1',
    roundResultTie:
      'âš–ï¸ ë¬´ìŠ¹ë¶€! âš”ï¸ã€{atkValue}ã€‘ ğŸ›¡ï¸ã€{defValue}ã€‘ â†’ ì¬êµ´ë¦¼',

    // í•© ìŠ¹ë¦¬ ë©”ì‹œì§€
    victory: 'ã€Ší•© ìŠ¹ë¦¬ã€‹- {winnerIcon} {winner} @í•©',

    // í•© ì¤‘ì§€ ë©”ì‹œì§€ (ì´ íŒ¨í„´ ê°ì§€ ì‹œ ì „íˆ¬ ì¤‘ì§€)
    combatCancel: 'ã€Ší•© ì¤‘ì§€ã€‹'
  },

  // â”€â”€ íƒ€ì´ë° ì„¤ì • (ë°€ë¦¬ì´ˆ) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  timing: {
    beforeFirstRoll: 1000,    // í•© í—¤ë” ì¶œë ¥ í›„ â†’ ì²« ë²ˆì§¸ êµ´ë¦¼ê¹Œì§€ ëŒ€ê¸°
    betweenRolls: 600,        // ê³µê²©ì ê²°ê³¼ í™•ì¸ í›„ â†’ ë°©ì–´ì êµ´ë¦¼ê¹Œì§€ ëŒ€ê¸°
    beforeRoundResult: 600,   // ë°©ì–´ì ê²°ê³¼ í™•ì¸ í›„ â†’ ê²°ê³¼ ì¶œë ¥ê¹Œì§€ ëŒ€ê¸°
    beforeNextRound: 1000,    // ê²°ê³¼ ì¶œë ¥ í›„ â†’ ë‹¤ìŒ í•©ê¹Œì§€ ëŒ€ê¸°
    beforeVictory: 1000,      // ë§ˆì§€ë§‰ í•© ê²°ê³¼ í›„ â†’ ìŠ¹ë¦¬ ì„ ì–¸ê¹Œì§€ ëŒ€ê¸°
    resultTimeout: 10000      // ì£¼ì‚¬ìœ„ ê²°ê³¼ ëŒ€ê¸° íƒ€ì„ì•„ì›ƒ (ì´ˆê³¼ ì‹œ ì¬ì‹œë„)
  },

  // â”€â”€ íš¨ê³¼ìŒ ì„¤ì • â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  sounds: {
    rollSounds: ['ì±™1', 'ì±™2', 'ì±™3'],   // ì£¼ì‚¬ìœ„ êµ´ë¦¼ ì‹œ ë¬´ì‘ìœ„ íš¨ê³¼ìŒ
    victorySounds: ['í•©']                  // ìŠ¹ë¦¬ ì‹œ íš¨ê³¼ìŒ
  },

  // â”€â”€ ì „íˆ¬ ê·œì¹™ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  rules: {
    diceType: 20,           // D20 (ì£¼ì‚¬ìœ„ ë©´ ìˆ˜)
    criticalValue: 20,      // ëŒ€ì„±ê³µ ê°’
    fumbleValue: 1,         // ëŒ€ì‹¤íŒ¨ ê°’
    criticalBonus: 1,       // ëŒ€ì„±ê³µ ì‹œ ì¶”ê°€ ì£¼ì‚¬ìœ„ ìˆ˜
    fumblePenalty: 1,       // ëŒ€ì‹¤íŒ¨ ì‹œ ì¶”ê°€ ê°ì†Œ ì£¼ì‚¬ìœ„ ìˆ˜
    tieRule: 'reroll'       // ë™ì  ì²˜ë¦¬: "reroll" | "bothLose" | "nothing" | "attackerWins" | "defenderWins"
  },

  // â”€â”€ ì •ê·œì‹ íŒ¨í„´ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  patterns: {
    // í•© ê°œì‹œ íŠ¸ë¦¬ê±° ê°ì§€ íŒ¨í„´
    // ì´ëª¨ì§€ ë’¤ì— ì„ íƒì  Variation Selector (U+FE0F)ë¥¼ í—ˆìš©
    triggerRegex:
      'ã€Ší•©\\s*ê°œì‹œã€‹\\s*\\|?\\s*âš”\\uFE0F?\\s*(.+?)\\s*-\\s*(\\d+)\\s*/\\s*(\\d+)\\s*/\\s*(\\d+)\\s*\\|?\\s*ğŸ›¡\\uFE0F?\\s*(.+?)\\s*-\\s*(\\d+)\\s*/\\s*(\\d+)\\s*/\\s*(\\d+)',

    // ì£¼ì‚¬ìœ„ ê²°ê³¼ ê°ì§€ íŒ¨í„´ (ìº¡ì²˜ ê·¸ë£¹ 1 = ê²°ê³¼ ê°’)
    diceResultRegex: '1[Dd]20[^0-9]*?[â†’ï¼>]\\s*(\\d+)',

    // ì „íˆ¬ ì¤‘ì§€ ê°ì§€ íŒ¨í„´
    cancelRegex: 'ã€Ší•©\\s*ì¤‘ì§€ã€‹'
  },

  // â”€â”€ DOM ì„ íƒì (ì½”ì½”í¬ë¦¬ì•„ ì „ìš©) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  selectors: {
    // ì±„íŒ… ë©”ì‹œì§€ ì»¨í…Œì´ë„ˆ (ìƒˆ ë©”ì‹œì§€ë¥¼ ê°ì‹œí•  ë¶€ëª¨ ìš”ì†Œ)
    chatContainer: [
      '[class*="MuiList-root"]',
      '[class*="chat-log"]',
      '[class*="message-list"]',
      '[role="log"]',
      '[class*="scroll"]'
    ],

    // ê°œë³„ ì±„íŒ… ë©”ì‹œì§€ ìš”ì†Œ
    chatMessage: [
      '[class*="MuiListItem"]',
      '[class*="message"]',
      '[class*="chat-item"]'
    ],

    // ë©”ì‹œì§€ í…ìŠ¤íŠ¸ë¥¼ í¬í•¨í•˜ëŠ” ìš”ì†Œ (ë©”ì‹œì§€ ì•ˆì—ì„œ)
    messageText: [
      '[class*="MuiTypography"]',
      '[class*="text"]',
      '[class*="content"]',
      '[class*="body"]',
      'p', 'span', 'div'
    ],

    // ì±„íŒ… ì…ë ¥ í•„ë“œ
    chatInput: [
      'textarea[name="text"]',
      'textarea.MuiInputBase-inputMultiline',
      'textarea',
      '[contenteditable="true"]'
    ],

    // ì „ì†¡ ë²„íŠ¼ (ì½”ì½”í¬ë¦¬ì•„: form ì•ˆì˜ submit ë²„íŠ¼)
    sendButton: [
      'form button[type="submit"]',
      'button[type="submit"]'
    ]
  },

  // â”€â”€ ì¼ë°˜ ì„¤ì • â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  general: {
    enabled: true,              // í™•ì¥ í”„ë¡œê·¸ë¨ í™œì„±í™”
    autoScroll: true,           // ìƒˆ ë©”ì‹œì§€ ì‹œ ìë™ ìŠ¤í¬ë¡¤
    showOverlay: true,          // í˜ì´ì§€ ë‚´ ì˜¤ë²„ë ˆì´ í‘œì‹œ
    debugMode: false,           // ë””ë²„ê·¸ ë¡œê·¸ ì¶œë ¥
    language: 'ko'              // UI ì–¸ì–´
  }
};

// í•œê¸€ ìˆ«ì ë³€í™˜ (í•© ë²ˆí˜¸ì— ì‚¬ìš©)
window.BWBR_KOREAN_NUMBERS = {
  1: '1', 2: '2', 3: '3', 4: '4', 5: '5',
  6: '6', 7: '7', 8: '8', 9: '9', 10: '10'
};
