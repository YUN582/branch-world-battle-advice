// ============================================================
// Branch World Battle Roll - ì„¤ì • ê¸°ë³¸ê°’
// ì½”ì½”í¬ë¦¬ì•„ GM ë³´ì¡° í™•ì¥ í”„ë¡œê·¸ë¨
// ============================================================

window.BWBR_DEFAULTS = {
  // â”€â”€ ë©”ì‹œì§€ í…œí”Œë¦¿ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  templates: {
    // í•© ê°œì‹œ íŠ¸ë¦¬ê±° (ì´ íŒ¨í„´ì´ ì±„íŒ…ì— ë‚˜íƒ€ë‚˜ë©´ ì „íˆ¬ ì‹œì‘)
    // {attacker}, {defender} = ì´ë¦„
    // {atkDice}, {atkCrit}, {atkFumble} = ê³µê²©ì ì£¼ì‚¬ìœ„/ëŒ€ì„±ê³µ/ëŒ€ì‹¤íŒ¨
    // {defDice}, {defCrit}, {defFumble} = ë°©ì–´ì ì£¼ì‚¬ìœ„/ëŒ€ì„±ê³µ/ëŒ€ì‹¤íŒ¨
    combatStart:
      'ã€Ší•© ê°œì‹œã€‹| âš”ï¸ {attacker} - {atkDice}/{atkCrit}/{atkFumble} | ğŸ›¡ï¸ {defender} - {defDice}/{defCrit}/{defFumble}',

    // ê° í•© í—¤ë”
    roundHeader:
      'ã€Š{round}í•©ã€‹| âš”ï¸ {attacker} {atkDice} : ğŸ›¡ï¸ {defender} {defDice} @{sound}',

    // ê³µê²©ì ì£¼ì‚¬ìœ„ êµ´ë¦¼ ëª…ë ¹
    attackerRoll: '1D20 âš”ï¸ {attacker}',

    // ë°©ì–´ì ì£¼ì‚¬ìœ„ êµ´ë¦¼ ëª…ë ¹
    defenderRoll: '1D20 ğŸ›¡ï¸ {defender}',

    // í•© ê²°ê³¼ ë©”ì‹œì§€
    roundResultWin:
      'âš”ï¸ {attacker}ã€{atkValue}ã€‘ vs ğŸ›¡ï¸ {defender}ã€{defValue}ã€‘ â†’ {winner} ìŠ¹ë¦¬!',
    roundResultCrit:
      'ğŸ’¥ {name} ëŒ€ì„±ê³µ! ã€{value}ã€‘ â†’ ìƒëŒ€ ì£¼ì‚¬ìœ„ íŒŒê´´ & ì£¼ì‚¬ìœ„ +1',
    roundResultFumble:
      'ğŸ’€ {name} ëŒ€ì‹¤íŒ¨! ã€{value}ã€‘ â†’ ìì‹  ì£¼ì‚¬ìœ„ íŒŒê´´ & ì£¼ì‚¬ìœ„ -1',
    roundResultBothCrit:
      'âš¡ ìŒë°© ëŒ€ì„±ê³µ! âš”ï¸ã€{atkValue}ã€‘ ğŸ›¡ï¸ã€{defValue}ã€‘ â†’ ê°ì ì£¼ì‚¬ìœ„ +1',
    roundResultTie:
      'âš–ï¸ ë¬´ìŠ¹ë¶€! âš”ï¸ã€{atkValue}ã€‘ ğŸ›¡ï¸ã€{defValue}ã€‘ â†’ ì¬êµ´ë¦¼',

    // í•© ìŠ¹ë¦¬ ë©”ì‹œì§€
    victory: 'ã€Ší•© ìŠ¹ë¦¬ã€‹\n{winnerIcon} {winner} @{sound}',

    // í•© ì¤‘ì§€ ë©”ì‹œì§€ (ì´ íŒ¨í„´ ê°ì§€ ì‹œ ì „íˆ¬ ì¤‘ì§€)
    combatCancel: 'ã€Ší•© ì¤‘ì§€ã€‹'
  },

  // â”€â”€ íƒ€ì´ë° ì„¤ì • (ë°€ë¦¬ì´ˆ) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  timing: {
    beforeFirstRoll: 700,     // í•© í—¤ë” ì¶œë ¥ í›„ â†’ ì²« ë²ˆì§¸ êµ´ë¦¼ê¹Œì§€ ëŒ€ê¸°
    betweenRolls: 700,        // ê³µê²©ì ê²°ê³¼ í™•ì¸ í›„ â†’ ë°©ì–´ì êµ´ë¦¼ê¹Œì§€ ëŒ€ê¸°
    beforeRoundResult: 700,   // ë°©ì–´ì ê²°ê³¼ í™•ì¸ í›„ â†’ ê²°ê³¼ ì¶œë ¥ê¹Œì§€ ëŒ€ê¸°
    beforeNextRound: 700,     // ê²°ê³¼ ì¶œë ¥ í›„ â†’ ë‹¤ìŒ í•©ê¹Œì§€ ëŒ€ê¸°
    beforeVictory: 700,       // ë§ˆì§€ë§‰ í•© ê²°ê³¼ í›„ â†’ ìŠ¹ë¦¬ ì„ ì–¸ê¹Œì§€ ëŒ€ê¸°
    resultTimeout: 3000       // ì£¼ì‚¬ìœ„ ê²°ê³¼ ëŒ€ê¸° íƒ€ì„ì•„ì›ƒ (ì´ˆê³¼ ì‹œ ì¬ì‹œë„)
  },

  // â”€â”€ íš¨ê³¼ìŒ ì„¤ì • â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  sounds: {
    combatStartSounds: ['í•©'],                        // í•© ê°œì‹œ ì‹œ íš¨ê³¼ìŒ
    roundHeaderSounds: ['ì±™ì±™1', 'ì±™ì±™2', 'ì±™ì±™3'],          // í•© í—¤ë” ì‹œ ë¬´ì‘ìœ„
    resultNormalSounds: ['ì±™ì±™1', 'ì±™ì±™2', 'ì±™ì±™3'],      // ì¼ë°˜ ê²°ê³¼ ì‹œ ë¬´ì‘ìœ„
    resultSpecialSounds: ['ì±™ì±™4'],                   // ëŒ€ì„±ê³µ/ëŒ€ì‹¤íŒ¨ ì‹œ ë¬´ì‘ìœ„
    victorySounds: ['í•©']                              // ìŠ¹ë¦¬ ì‹œ ë¬´ì‘ìœ„
  },

  // â”€â”€ ì „íˆ¬ ê·œì¹™ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  rules: {
    diceType: 20,           // D20 (ì£¼ì‚¬ìœ„ ë©´ ìˆ˜)
    criticalValue: 20,      // ëŒ€ì„±ê³µ ê°’
    fumbleValue: 1,         // ëŒ€ì‹¤íŒ¨ ê°’
    criticalBonus: 1,       // ëŒ€ì„±ê³µ ì‹œ ì¶”ê°€ ì£¼ì‚¬ìœ„ ìˆ˜
    fumblePenalty: 1,       // ëŒ€ì‹¤íŒ¨ ì‹œ ì¶”ê°€ ê°ì†Œ ì£¼ì‚¬ìœ„ ìˆ˜
    tieRule: 'reroll'       // ë™ì  ì²˜ë¦¬: "reroll" | "bothLose" | "nothing" | "attackerWins" | "defenderWins"
  },

  // â”€â”€ ì •ê·œì‹ íŒ¨í„´ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  patterns: {
    // í•© ê°œì‹œ íŠ¸ë¦¬ê±° ê°ì§€ íŒ¨í„´
    // ì´ëª¨ì§€ ë’¤ì— ì„ íƒì  Variation Selector (U+FE0F)ë¥¼ í—ˆìš©
    // ë§ˆì§€ë§‰ ìŠ¬ë˜ì‹œ ë’¤ì— ì„ íƒì  íŠ¹ì„± íƒœê·¸ (H0H4 ë“±) ìºì²˜
    triggerRegex:
      'ã€Ší•©\\s*ê°œì‹œã€‹\\s*\\|?\\s*âš”\\uFE0F?\\s*(.+?)\\s*-\\s*(\\d+)\\s*/\\s*(\\d+)\\s*/\\s*(\\d+)(?:\\s*/\\s*([A-Za-z0-9]+))?\\s*\\|?\\s*ğŸ›¡\\uFE0F?\\s*(.+?)\\s*-\\s*(\\d+)\\s*/\\s*(\\d+)\\s*/\\s*(\\d+)(?:\\s*/\\s*([A-Za-z0-9]+))?',

    // ì£¼ì‚¬ìœ„ ê²°ê³¼ ê°ì§€ íŒ¨í„´ (ìº¡ì²˜ ê·¸ë£¹ 1 = ê²°ê³¼ ê°’)
    diceResultRegex: '1[Dd]20[^0-9]*?[â†’ï¼>]\\s*(\\d+)',

    // ì „íˆ¬ ì¤‘ì§€ ê°ì§€ íŒ¨í„´
    cancelRegex: 'ã€Ší•©\\s*ì¤‘ì§€ã€‹'
  },

  // â”€â”€ DOM ì„ íƒì (ì½”ì½”í¬ë¦¬ì•„ ì „ìš©) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  selectors: {
    // ì±„íŒ… ë©”ì‹œì§€ ì»¨í…Œì´ë„ˆ (ìƒˆ ë©”ì‹œì§€ë¥¼ ê°ì‹œí•  ë¶€ëª¨ ìš”ì†Œ)
    chatContainer: [
      '[class*="MuiList-root"]',
      '[class*="chat-log"]',
      '[class*="message-list"]',
      '[role="log"]',
      '[class*="scroll"]'
    ],

    // ê°œë³„ ì±„íŒ… ë©”ì‹œì§€ ìš”ì†Œ
    chatMessage: [
      '[class*="MuiListItem"]',
      '[class*="message"]',
      '[class*="chat-item"]'
    ],

    // ë©”ì‹œì§€ í…ìŠ¤íŠ¸ë¥¼ í¬í•¨í•˜ëŠ” ìš”ì†Œ (ë©”ì‹œì§€ ì•ˆì—ì„œ)
    messageText: [
      '[class*="MuiTypography"]',
      '[class*="text"]',
      '[class*="content"]',
      '[class*="body"]',
      'p', 'span', 'div'
    ],

    // ì±„íŒ… ì…ë ¥ í•„ë“œ
    chatInput: [
      'textarea[name="text"]',
      'textarea.MuiInputBase-inputMultiline',
      'textarea',
      '[contenteditable="true"]'
    ],

    // ì „ì†¡ ë²„íŠ¼ (ì½”ì½”í¬ë¦¬ì•„: form ì•ˆì˜ submit ë²„íŠ¼)
    sendButton: [
      'form button[type="submit"]',
      'button[type="submit"]'
    ]
  },

  // â”€â”€ ì¼ë°˜ ì„¤ì • â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  general: {
    enabled: true,              // í™•ì¥ í”„ë¡œê·¸ë¨ í™œì„±í™”
    manualMode: false,          // ìˆ˜ë™ ëª¨ë“œ (ì£¼ì‚¬ìœ„ ê²°ê³¼ë¥¼ ì‚¬ìš©ìê°€ ì§ì ‘ ì…ë ¥)
    showBattleLog: false,       // ì „íˆ¬ ë¡œê·¸ í‘œì‹œ (UI ë¡œê·¸ ì˜ì—­ í‘œì‹œ ì—¬ë¶€)
    autoComplete: true,         // ì±„íŒ… ìë™ì™„ì„± (ê´„í˜¸/ë”°ì˜´í‘œ ìë™ ë‹«ê¸° + Tab ìˆœí™˜)
    autoScroll: true,           // ìƒˆ ë©”ì‹œì§€ ì‹œ ìë™ ìŠ¤í¬ë¡¤
    showOverlay: true,          // í˜ì´ì§€ ë‚´ ì˜¤ë²„ë ˆì´ í‘œì‹œ
    autoConsumeActions: true,   // ì£¼/ë³´ì¡° í–‰ë™ ìë™ ì†Œëª¨ (ã€Š...ã€‹ã€...ã€‘ íŒ¨í„´ ê°ì§€ ì‹œ)
    debugMode: false,           // ë””ë²„ê·¸ ë¡œê·¸ ì¶œë ¥
    sfxVolume: 0.45,            // í™•ì¥ í”„ë¡œê·¸ë¨ íš¨ê³¼ìŒ ë³¼ë¥¨ (0~1)
    siteVolume: 1.0,            // ì½”ì½”í¬ë¦¬ì•„ ì‚¬ì´íŠ¸ ìŒëŸ‰ (0~1)
    language: 'ko'              // UI ì–¸ì–´
  },

  // â”€â”€ ì¢…ì¡± íŠ¹ì„± ì •ì˜ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  traits: {
    H0: { name: 'ì¸ê°„ íŠ¹ì„±', desc: 'ì£¼ì‚¬ìœ„ 0 ì‹œ +1 ë¶€í™œ, í¬ë¦¬ ì‹œ ì´ˆê¸°í™”' },
    H00: { name: 'ì¸ê°„ íŠ¹ì„± (ì ì¬)', desc: 'íŠ¹ì„± ì—†ì§€ë§Œ ëŒ€ì„±ê³µ ì‹œ ì´ˆê¸°í™”ë˜ì–´ ì‚¬ìš© ê°€ëŠ¥' },
    H1: { name: 'ê³µì„', desc: '' },
    H2: { name: 'ê³µì„', desc: '' },
    H3: { name: 'ê³µì„', desc: '' },
    H4: { name: 'í”¼ë¡œ ìƒˆê²¨ì§„ ì—­ì‚¬', desc: 'í¬ë¦¬ ì‹œ ë‹¤ìŒ íŒì • ëŒ€ì„±ê³µ+2, ìµœëŒ€+5 ëˆ„ì , ë¹„í¬ë¦¬ ì‹œ ì´ˆê¸°í™”' },
    H40: { name: 'í”¼ë¡œ ìƒˆê²¨ì§„ ì—­ì‚¬ + ì¸ê°„', desc: 'H4 ìŠ¤íƒ ì´ˆê¸°í™” ì‹œ ì¸ê°„ íŠ¹ì„± ë°œë™ â†’ ì¶”ê°€ í•© 1íšŒ' },
    H400: { name: 'í”¼ë¡œ ìƒˆê²¨ì§„ ì—­ì‚¬ + ì¸ê°„', desc: 'ëŒ€ì„±ê³µìœ¼ë¡œ ì¸ê°„ íŠ¹ì„± íšë“ í›„, H4 ì´ˆê¸°í™” ì‹œ ë°œë™ â†’ ì¶”ê°€ í•© 1íšŒ' }
  }
};

// í•œê¸€ ìˆ«ì ë³€í™˜ (í•© ë²ˆí˜¸ì— ì‚¬ìš©)
window.BWBR_KOREAN_NUMBERS = {
  1: '1', 2: '2', 3: '3', 4: '4', 5: '5',
  6: '6', 7: '7', 8: '8', 9: '9', 10: '10'
};
